<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yukun's Blog</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; background-color: #f0f2f5; display: flex; justify-content: center; }
        #root { width: 100%; max-width: 700px; padding: 20px; }
    </style>
</head>
<body>
    <div id="root">å†…å®¹åŠ è½½ä¸­ï¼Œè¯·ç¨å€™...</div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- å­ç»„ä»¶ï¼šæ—¥å†è§†å›¾ ---
        function CalendarView({ selectedDate, onDateClick }) {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth();
            const todayStr = new Date().toLocaleDateString();

            const firstDayOfMonth = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            const days = [];
            for (let i = 0; i < firstDayOfMonth; i++) {
                days.push(<div key={`e-${i}`} />);
            }

            for (let d = 1; d <= daysInMonth; d++) {
                const dateStr = new Date(year, month, d).toLocaleDateString();
                const isToday = dateStr === todayStr;
                const isSelected = dateStr === selectedDate;

                days.push(
                    <div key={d} onClick={() => onDateClick(dateStr)}
                        style={{
                            padding: "6px 0", textAlign: "center", borderRadius: "6px", cursor: "pointer",
                            backgroundColor: isSelected ? "#45B7D1" : (isToday ? "#4caf50" : "transparent"),
                            color: (isSelected || isToday) ? "white" : "#333",
                            fontSize: "0.75rem", border: isSelected ? "none" : "1px solid #f0f0f0", transition: "0.2s"
                        }}>
                        {d}
                    </div>
                );
            }

            return (
                <div style={{ padding: "15px", backgroundColor: "#fff", borderRadius: "12px", border: "1px solid #eee", width: "200px", boxShadow: "0 2px 8px rgba(0,0,0,0.05)" }}>
                    <div style={{ fontSize: "0.9rem", fontWeight: "bold", textAlign: "center", marginBottom: "10px", color: "#444" }}>
                        {year}å¹´ {month + 1}æœˆ
                    </div>
                    <div style={{ display: "grid", gridTemplateColumns: "repeat(7, 1fr)", gap: "4px" }}>
                        {["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"].map(w => (
                            <div key={w} style={{ textAlign: "center", fontSize: "0.7rem", color: "#999" }}>{w}</div>
                        ))}
                        {days}
                    </div>
                </div>
            );
        }

        function App() {
            const [date, setDate] = useState(new Date().toLocaleDateString());
            const [selectedDate, setSelectedDate] = useState(new Date().toLocaleDateString());
            const [weather, setWeather] = useState("â˜€ï¸ æ­£åœ¨è·å–å¤©æ°”...");
            const [taskInput, setTaskInput] = useState("");
            const [allTasks, setAllTasks] = useState(() => {
                const saved = localStorage.getItem("yukun_blog_tasks");
                return saved ? JSON.parse(saved) : {};
            });

            useEffect(() => {
                localStorage.setItem("yukun_blog_tasks", JSON.stringify(allTasks));
            }, [allTasks]);

            useEffect(() => {
                const fetchWeather = async () => {
                    try {
                        const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=37.35&longitude=-121.95&current_weather=true&temperature_unit=celsius`);
                        const data = await res.json();
                        const tempC = data.current_weather.temperature;
                        setWeather(`â˜€ï¸ ${tempC}Â°C / ${((tempC * 9) / 5 + 32).toFixed(1)}Â°F`);
                    } catch (e) { setWeather("âš ï¸ è·å–å¤±è´¥"); }
                };
                fetchWeather();
            }, []);

            const currentTasks = allTasks[selectedDate] || [];

            const addTask = () => {
                if (!taskInput.trim()) return;
                const newTask = { id: Date.now(), text: taskInput, completed: false };
                setAllTasks({ ...allTasks, [selectedDate]: [...currentTasks, newTask] });
                setTaskInput("");
            };

            const toggleTask = (id) => {
                setAllTasks({
                    ...allTasks,
                    [selectedDate]: currentTasks.map(t => t.id === id ? { ...t, completed: !t.completed } : t)
                });
            };

            const rainbowText = (text) => {
                const colors = ["#4ECDC4", "#45B7D1", "#98D8C8", "#F7DC6F", "#BB8FCE"];
                return text.split("").map((c, i) => <span key={i} style={{ color: colors[i % colors.length] }}>{c}</span>);
            };

            return (
                <div style={{ background: "white", padding: "30px", borderRadius: "20px", boxShadow: "0 10px 30px rgba(0,0,0,0.08)", marginTop: "20px" }}>
                    <div style={{ backgroundColor: "#e8f5e9", padding: "20px", borderRadius: "15px", textAlign: "center", marginBottom: "30px" }}>
                        <h1 style={{ fontSize: "2.2rem", margin: 0 }}>{rainbowText("Welcome Yukun's Blog")}</h1>
                    </div>

                    <div style={{ display: "flex", justifyContent: "space-between", gap: "20px", flexWrap: "wrap" }}>
                        <div style={{ flex: 1, minWidth: "280px" }}>
                            <div style={{ display: "flex", justifyContent: "space-between", fontSize: "0.85rem", color: "#666", marginBottom: "15px" }}>
                                <span>ä»Šå¤©: {date}</span>
                                <span>{weather}</span>
                            </div>
                            <div style={{ marginBottom: "15px", padding: "8px", backgroundColor: "#f0f7ff", borderRadius: "8px", fontSize: "0.85rem", color: "#007bff", borderLeft: "4px solid #45B7D1" }}>
                                ğŸ“… æŸ¥çœ‹: <strong>{selectedDate}</strong>
                            </div>
                            <div style={{ display: "flex", gap: "10px", marginBottom: "20px" }}>
                                <input value={taskInput} onChange={e => setTaskInput(e.target.value)} style={{ flex: 1, padding: "8px", borderRadius: "6px", border: "1px solid #ddd" }} placeholder="è¾“å…¥ä»»åŠ¡..." />
                                <button onClick={addTask} style={{ padding: "8px 15px", backgroundColor: "#4caf50", color: "white", border: "none", borderRadius: "6px", cursor: "pointer" }}>æ·»åŠ </button>
                            </div>
                            <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "15px", textAlign: "left" }}>
                                <div><h5 style={{ color: "#f44336", margin: "0 0 10px 0" }}>æœªå®Œæˆ</h5>
                                    {currentTasks.filter(t => !t.completed).map(t => <div key={t.id} onClick={() => toggleTask(t.id)} style={{ cursor: "pointer", fontSize: "0.9rem", marginBottom: "5px" }}>â€¢ {t.text}</div>)}
                                </div>
                                <div><h5 style={{ color: "#9e9e9e", margin: "0 0 10px 0" }}>å·²å®Œæˆ</h5>
                                    {currentTasks.filter(t => t.completed).map(t => <div key={t.id} onClick={() => toggleTask(t.id)} style={{ cursor: "pointer", fontSize: "0.9rem", color: "#bbb", textDecoration: "line-through", marginBottom: "5px" }}>â€¢ {t.text}</div>)}
                                </div>
                            </div>
                        </div>
                        <CalendarView selectedDate={selectedDate} onDateClick={setSelectedDate} />
                    </div>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
